# Data Center Network Arch

---

## Network

### 数据中心网络

- 三层标准网络架构，*南北向网络流量的主要架构*
  - 机顶主备（机底，机柜中）交换机（TOR），*这里还会涉及到三层的子网划分，和二层Vlan网路的划分。三层子网是确定本地网路IP分布，二层Vlan是防止ARP风暴*
  - 汇聚交换机，*三种接口，access，trunk，hynird*
  - 核心交换机，*核心交换机包含所有路由表，所以你适合南北向，如果东西向会造成流量始终需要核心查找路由*
  - 外网流量，*将外网流量直接接入得到汇聚，然后将流量的IP转到直接连接核心交换机上LB（F5）将外网IP替换成内网IP，再进一步通过核心路由*

- Spine-Leaf网络架构，*将数据中心切分成独立的类似集装箱的立体网格**Fabric***
  - 汇聚交换机，**Spine***多台串联在一起，组成网络中枢*
  - 机顶交换机（TOR），**Leaf***接入机顶交换的组成独立的As路犹域*
  - 外网流量，*因为没有的特定的核心交换机，所以外网流量和内网的AS域流量一样接入到汇聚到交换机*
  - 网箱流量，*网箱内部的流量都通过汇聚交换机实现发现和路由，网箱与网箱之间流量是无法使用汇聚交换机来路由的，所以需要定义一组Edge（边缘）路由接入到网箱之上数据中心网路上，这样可以发现其他网箱，也可以被其他的网箱发现，实现数据中心互联*

#### Spine-Leaf 网络架构思考

- ECMP对等路由协议支持。每个AS域都会接入到所有网箱中的汇聚交换机，这样就需要支持ECMP对等路由支持。东西向的流量可以多个汇聚交换机到达对应的AS域，网络流量不会被占用。三层标准网络架构，因为流量必须通过核心去路由，所以路由通道只有一条，是
- BGP路由发现协议支持。网箱外和网箱内都需要通过BGP协议发现各自管理的AS域，网箱内一个机顶交换机相当于AS域，网箱外一个网箱相当于一个AS域。
  - 路由反射器（RR，Route Reflector）
  - 客户机（Client）
  - 非客户机（Non-Client），既不是RR，也不是客户端的IBGP设备
  - 集群（Cluster）
