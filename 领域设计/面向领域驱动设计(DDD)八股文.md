# 应用架构设计的八股文

## 概要设计（确定产品组件，依赖组件）

产品整体模块呈现，展示该产品所涉及到所有的功能模块，可以包含内部，和外部功能模块。

### USER CASE，用例设计

将需求进行模块化，用户化拆分。明确需求设计的用户，功能模块。

### 领域设计

根据需求，将需求对应落到对应的各个领域模块中，主要是将需求边界划分清楚。能够清晰的了解本次需求实现中，需要的外部依赖，内部依赖有哪些，提前给出需求实现的领域全景。

领域服务包含：

- 接口
- 消息
- 事件

领域之间可以通过服务，事件或消息来获取领域信息

### 数据流设计

明确领域边界后，划分领域与领域之间的数据流向，流量上下文划分清晰。

### 状态设计（如果有）

如果设计到流程，事物等需求时，需要将状态机提前设计清晰，每个状态机转变所涉及到event等。状态机一般使用2的指数进行变化，比如2，16，32，为了解决状态机后续扩展更多的状态。

### 逻辑架构

领域设计的分层架构，分为用户层（UI），接入层（service aggregation） ，领域层（Domain/ business core），和数据层（infrastructure），当然有时候可以使用数据层倒置的设计方案。

其中数据层（infrastructure）包含所有的对外数据请求，以及自身的数据库，缓存等数据请求。

### UML（类设计）

领域设计后，对于具体的实现给出类图设计。

### 物理架构（部署设计）

对于应用上线后，对应的部署和使用到的物理组件（服务器，LB，域名，数据库和协议等）

### 非功能性设计（性能，稳定性，以及错误流程等）

需要在设计的时候考虑到错误流程，新旧程序切换过度中的相关问题，以及满足需求对应的用户量，请求量和耗时要求。

---

## 详细设计

### 接口设计

- 接口协议
- 接口路径
- 接口契约

### 业务流程设计

接口逻辑的后端执行业务逻辑，并包含出错逻辑

### 数据实体设计（表设计，E-R图）

领域设计的数据对象包含的所需字段，对应到的可能是多张表和多个E-R图是包含在数据层中的设计。

### 出错设计

错误码设计，包含具体的错误定义和错误原因。
